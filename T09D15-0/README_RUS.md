# T09D15

![This day will help you get acquainted with multifile projects.](misc/rus/images/day9_door.png)


## Contents

1. [Chapter I](#chapter-i) \
 1.1. [Level 3. Room 1.](#level-3-room-1) 
2. [Chapter II](#chapter-ii) \
 2.1. [List 1.](#list-1)
3. [Chapter III](#chapter-iii) \
 3.1. [Quest 1. Modules.](#quest-1-modules) \
 3.2. [Quest 2. Modules II.](#quest-2-modules-ii) \
 3.3. [Quest 3. Makefile.](#quest-3-makefile) \
 3.4. [Quest 4. Macro.](#quest-4-macro) \
 3.5. [Quest 5. Static Lib.](#quest-5-static-lib) \
 3.6. [Quest 6. Dynamic Lib.](#quest-6-dynamic-lib) 
4. [Chapter IV](#chapter-iv) 


# Chapter I

## Level 3. Room 1.

***LOADING Level 3… \
LOADING Room 1…***

Вы ловите себя на созерцании пульсирующих в черном океане структур из "Игры жизни" и понимаете, что, скорее всего, задремали. Вы открывате глаза и обнаруживаете себя сидящим в довольно удобном кресле перед большим, массивным столом. Напротив Вас, на стенах очередной комнаты, висят распечатанные длинные полотнища кода, похожие на древние свитки. Они испещрены пометками, стрелками, подчеркиваниями и прочими следами интеллектуальной деятельности. 

![day9_chair](misc/rus/images/day9_chair.png)

\> *Оглядеться*

Помимо потрепанной и не вызывающей особого доверия брошюры "Препроцессор языка Си. Макроопределения. Гайд для профессионалов.", на столе стоит монитор, обклеенный стикерами. В основном, на них ничего не значащие для вас даты, имена и события чьей-то работы и личной жизни. Ваше внимание привлекает стикер ярко-красного цвета:

>Необходимо навести порядок в модулях. Невыносимо больше работать с этими бесконечными портянками кода. Видимо, никто кроме меня это не сделает.

И приписка:

>Подготовил все необходимые материалы на компьютере. Осталось доработать пару моментов. Работа идет медленно. Постоянно отвлекают текущие задачи и новые фичи. Но рефакторинг - это важно. Иначе мы просто коллапсируем в определенный момент. Все развалится.

Этот стикер удерживает еще одну бумажку, размером с половину печатного листа

\> *Читать*

***LOADING...***


# Chapter II

## List 1.

>Заголовочный файл — файл, содержимое которого автоматически добавляется препроцессором в исходный текст в том месте, где располагается директива включения (#include <file.h>).
>В языках программирования С/C++ заголовочные файлы — основной способ подключить к программе типы данных, структуры, прототипы функций, перечисляемые типы и макросы, используемые в другом модуле. По умолчанию используется расширение .h. 
>Чтобы избежать повторного включения одного и того же кода, используются директивы #ifndef, #define, #endif.

Вы замечаете, что лист как бы сложен пополам.

\> *Аккуратно развернуть лист*

***LOADING...***


## List 2.

>In software development, Make is a build automation tool that automatically builds executable programs and libraries from source code by reading files called Makefiles which specify how to derive the target program. 
>Though integrated development environments and language-specific compiler features can also be used to manage a build process, Make remains widely used, especially in Unix and Unix-like operating systems.

\> *Ясно. Включить компьютер*

На экране загрузки замелькал уже знакомый вам текст:

> Не забывайте проверять свои программы на стилевую норму и утечки памяти! \
> Не забывайте проверять свои программы на стилевую норму и утечки памяти! \
> Не забывайте проверять свои программы на стилевую норму и утечки памяти! \
> Заглядывайте в `materials` почаще.....


***LOADING...***


# Chapter III

## Quest 1. Modules.

Компьютер загружался подозрительно долго. Наконец, вы увидели загрузку терминала и следующий текст:

    Приветственное сообщение рабочей станции #771.
    Сообщение поставлено в автозагрузку.
    Шлюз 1-й комнаты 3-го уровня находится на техническом обслуживании.
    Статус технического обслуживания:
     1. Начат рефакторинг модулей из директории src.
     2. Работоспособность модулей нарушена.
    Проверка:
     1. Load data_module ... FAIL.
    Необходимо закончить рефакторинг указанных модулей.
    Разбивку на файлы не менять, она согласована с ведущим архитектором.

    Перезагрузите систему, как будет готово.
    
***== Получен Quest 1. Доработать модуль src/data_module таким образом, чтобы src/data_module_entry.c запускался и работал корректно. Обратить внимание на директорию data_libs. Максимально переиспользовать имеющиеся файлы и функции, применяя соответствующие директивы препроцессора. ==***

***LOADING…***


## Quest 2. Modules II.

\> *Готово. Перезагрузить компьютер*

После перезагрузки дело пошло шустрее:

    Приветственное сообщение рабочей станции #771.
    Сообщение поставлено в автозагрузку.
    Шлюз 1-й комнаты 3-го уровня находится на техническом обслуживании.
    Статус технического обслуживания:
     1. Начат рефакторинг модулей из директории src.
     2. Работоспособность модулей нарушена.
    Проверка модулей:
     1. Load data_module ... SUCCESS.
     2. Load yet_another_decision_module ... FAIL.
    Необходимо закончить рефакторинг указанных модулей.
    Разбивку на файлы не менять, она согласована с ведущим архитектором.
    
    Перезагрузите систему, как будет готово.

***== Получен Quest 2. Доработать модуль src/yet_another_decision_module таким образом, чтобы src/yet_another_decision_module_entry.c запускался и работал корректно. Обратить внимание на директорию data_libs. Максимально переиспользовать имеющиеся файлы и функции, применяя соответствующие директивы препроцессора.  ==***

***LOADING…***


## Quest 3. Makefile.

\> *Готово. Перезагрузить компьютер #2*

Компьютер весело зашуршал винчестером:

    Приветственное сообщение рабочей станции #771.
    Сообщение поставлено в автозагрузку.
    Шлюз 1-й комнаты 3-го уровня находится на техническом обслуживании.
    Статус технического обслуживания:
     1. Начат рефакторинг модулей из директории src.
     2. Работоспособность модулей нарушена.
    Проверка модулей:
     1. Load data_module ... SUCCESS.
     2. Load yet_another_decision_module ... SUCCESS.
     3. Make main_executable_module ... FAIL
    Необходимо доработать процесс сборки в части Makefile.
    Немного не успел закончить. Планировал добавить стандартные цели (clean, all, rebuild)

    Перезагрузите систему, как будет готово.

> **Внимание!** Все пути в Makefile необходимо указывать относительно той директории, в которой он расположен, т.к. именно из нее он будет запускаться 

***== Получен Quest 3. Доработать модуль src/main_executable_module таким образом, чтобы src/main_executable_module/main_executable_module.c запускался и работал корректно. Разработать Makefile для сборки решения и поместить его в директорию с исходным кодом. В Makefile предусмотреть стандартные цели: clean, all, rebuild. При разработке Makefile руководствоваться стандартными решениями, применяемыми при разработке программ на языке Си. Скомпилированный файл должен располагаться в папке build, в корне репозитория и иметь имя Quest_3. Сам результат компиляции загружать в репозиторий не нужно. ==***

***LOADING…***


## Quest 4. Macro.

\> *Готово. Перезагрузить компьютер #3*

Компьютер пошел на взлет:

    Приветственное сообщение рабочей станции #771.
    Сообщение поставлено в автозагрузку.
    Шлюз 1-й комнаты 3-го уровня находится на техническом обслуживании.
    Статус технического обслуживания:
     1. Начат рефакторинг модулей из директории src.
     2. Работоспособность модулей нарушена.
    Проверка модулей:
     1. Load data_module ... SUCCESS.
     2. Load yet_another_decision_module ... SUCCESS.
     3. Make main_executable_module ... SUCCESS.
     4. Load check_list ...
     4.1. Добавить реализацию data_io_macro.h в папку src/data_libs на параметрических макросах, принимающих массив,
     размер и формат для работы с массивами разных типов. В Макеfile добавить цель build_with_macro. 
     Немного доработать main_executable_module.c.
     ...
     
    Нажмите Enter, как будет готово.

***== Получен Quest 4. Добавить в папку src/data_libs реализацию data_io_macro.h с помощью параметризованных многострочных макроопределений. Реализация должна работать с массивами любых типов. Доработать main_executable_module.c таким образом, чтобы была возможность конфигурировать с помощью макроса подключение header-файла модуля io (стандартная реализация data_io.h или data_io_macro.h). Добавить в Makefile цель build_with_macro для сборки main_executable_module с data_io_macro.h, подредактировав, при необходимости, цель all (для работы с  data_io.h). Скомпилированный файл должен располагаться в папке build, в корне репозитория и иметь имя Quest_4. Сам результат компиляции загружать в репозиторий не нужно. ==***

***LOADING...***


## Quest 5. Static Lib.

\> *Enter*

     4. Load check_list ...
     4.1. Добавить реализацию data_io_macro.h на параметрических макросах, принимающих массив,
     размер и формат для работы с массивами разных типов. В Макеfile добавить цель build_with_macro... DONE.
     4.2. Собрать data_stat как статическую библиотеку (.a). В Макеfile добавить цель build_with_static.
     
    Нажмите Enter, как будет готово.

***== Получен Quest 5. Добавить в Makefile цель data_stat.a, собирающую модуль data_stat как статическую библиотеку data_stat.a. Добавить в Makefile цель build_with_static, собирающую main_executable_module с подключением модуля data_stat как статической библиотеки. Загружать data_stat.a в репозиторий нельзя, как и любой другой результат компиляции и сборки (объектный файл, статическая или динамическая библиотека, исполняемый файл). Скомпилированный файл должен располагаться в папке build, в корне репозитория и иметь имя Quest_5. ==***

***LOADING...***


## Quest 6. Dynamic Lib.

\> *Enter #2*

     4. Load check_list ...
     4.1. Добавить реализацию data_io_macro.h на параметрических макросах, принимающих массив,
     размер и формат для работы с массивами разных типов. В Макеfile добавить цель build_with_macro... DONE.
     4.2. Собрать data_stat как статическую библиотеку (.a). В Макеfile добавить цель build_with_static.... DONE.
     4.3. Собрать data_process как динамическую библиотеку (.so). В Макеfile добавить цель build_with_dynamic.
     
    Нажмите Enter, как будет готово.

***== Получен Quest 6. Добавить в Makefile цель data_process.so, собирающую модуль data_process.so как динамиечскую библиотеку data_process.so. Добавить в Makefile цель build_with_dynamic, собирающую main_executable_module с подключением модуля data_process как динамической библиотеки. Внести необходимые изменения в код main_executable_module, конфигурировав использование динамической библиотеки с помощью макросов. Загружать data_process.so в репозиторий нельзя, как и любой другой результат сборки. Скомпилированный файл должен располагаться в папке build, в корне репозитория и иметь имя Quest_6. ==***

***LOADING...***


# Chapter IV

\> *Enter*

     4. Load check_list ...
     4.1. Добавить реализацию data_io_macro.h на параметрических макросах, принимающих массив, 
     размер и формат для работы с массивами разных типов. В Макеfile добавить цель build_with_macro... DONE.
     4.2. Собрать data_stat как статическую библиотеку (.a). В Макеfile добавить цель build_with_static.... DONE.
     4.2. Собрать data_process как динамическую библиотеку (.so). В Макеfile добавить цель build_with_dynamic...DONE
     .....
     Initialising....
     .....
     Техническое обслуживание шлюза 1-й комнаты 3-го уровня завершено.
     .....
     Проверка дверных механизмов... двери открыты...
     Пожалуйста, оцените степень открытости дверей по шкале от 1 до 10:
     >>_

\> *Я же могу просто выйти?*

Попробуйте!

\> *Выйти в дверь* 

Вы успешно вышли в дверь. Как-то слишком просто и ИИ куда-то пропал.. Все это крайне подозрительно. Но - лучше идти вперед, чем не идти. Банально, - но правдиво.

***LOADING...***

